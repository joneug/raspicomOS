#!/usr/bin/env bash
set -x
set -e

source /common.sh

apt-get update

# Configure soundcard
echo "dtoverlay=$SOUNDCARD" >> /boot/config.txt
cat <<EOT >> /etc/asound.conf
pcm.!default {
  type asym
  playback.pcm "plughw:0"
  capture.pcm  "plughw:1"
}
EOT

# Install required packages
apt-get install -y libopenal-dev libopus-dev libasound2-dev ffmpeg git vim

# Install Go
curl -L -o go.tar.gz https://golang.org/dl/go$GO_VERSION.linux-armv6l.tar.gz
tar -C /usr/local -xzf go.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' > /etc/profile

apt-get clean
apt-get autoremove -y
